<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>Zumo Assignment: robotcode/robotcode.ino File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Zumo Assignment
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97e877d6dd3b0b5040d7756fd1231e5d.html">robotcode</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">robotcode.ino File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Zumo Search and Rescue Robot using Arduino Uno.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;ZumoMotors.h&gt;</code><br />
<code>#include &lt;QTRSensors.h&gt;</code><br />
<code>#include &lt;ZumoReflectanceSensorArray.h&gt;</code><br />
<code>#include &lt;NewPing.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for robotcode.ino:</div>
<div class="dyncontent">
<div class="center"><img src="robotcode_8ino__incl.png" border="0" usemap="#robotcode_2robotcode_8ino" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMOVEMENT__COORD.html">MOVEMENT_COORD</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure that is used for logging of actions.  <a href="structMOVEMENT__COORD.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab4553be4db9860d940f81d7447173b2f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab4553be4db9860d940f81d7447173b2f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LED_PIN</b>&#160;&#160;&#160;13</td></tr>
<tr class="separator:ab4553be4db9860d940f81d7447173b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add02d1c189e3b727b722638327642a8b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="add02d1c189e3b727b722638327642a8b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_SENSORS</b>&#160;&#160;&#160;6</td></tr>
<tr class="separator:add02d1c189e3b727b722638327642a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adacee581176b7076b7baf0f72d81460f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adacee581176b7076b7baf0f72d81460f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TRIGGER_PIN</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:adacee581176b7076b7baf0f72d81460f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea96cea4a13b6cb38e57a86788adf90"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acea96cea4a13b6cb38e57a86788adf90"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ECHO_PIN</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:acea96cea4a13b6cb38e57a86788adf90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e4da5f3d0c7936fa52467f40e4b6aa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a08e4da5f3d0c7936fa52467f40e4b6aa"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_DISTANCE</b>&#160;&#160;&#160;20</td></tr>
<tr class="separator:a08e4da5f3d0c7936fa52467f40e4b6aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c43ff28382fa323973c476e7587b27f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8c43ff28382fa323973c476e7587b27f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_COORDINATES</b>&#160;&#160;&#160;60</td></tr>
<tr class="separator:a8c43ff28382fa323973c476e7587b27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a251d94cd24a2ca3369fc3f8eca8c19ae"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a251d94cd24a2ca3369fc3f8eca8c19ae"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_ROOMS</b>&#160;&#160;&#160;5</td></tr>
<tr class="separator:a251d94cd24a2ca3369fc3f8eca8c19ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2cd96d53dd3ba6407db6766c3d92b26"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2cd96d53dd3ba6407db6766c3d92b26"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>MAX_SPEED</b>&#160;&#160;&#160;120</td></tr>
<tr class="separator:ac2cd96d53dd3ba6407db6766c3d92b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acff0705eddd3534f7287eccf7bae20bb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acff0705eddd3534f7287eccf7bae20bb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_CALIBRATE</b>&#160;&#160;&#160;'1'</td></tr>
<tr class="separator:acff0705eddd3534f7287eccf7bae20bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a122a1d4695ae651ca004d41e1d00b6e4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a122a1d4695ae651ca004d41e1d00b6e4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_CHECK_ROOM</b>&#160;&#160;&#160;'2'</td></tr>
<tr class="separator:a122a1d4695ae651ca004d41e1d00b6e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69a016ef92ad9ddb73560a123445502b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a69a016ef92ad9ddb73560a123445502b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_START_AUTONOMOUS</b>&#160;&#160;&#160;'3'</td></tr>
<tr class="separator:a69a016ef92ad9ddb73560a123445502b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14691deb9ba5dc93a2bb3e0e8b4fdfd5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a14691deb9ba5dc93a2bb3e0e8b4fdfd5"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_WALL_DETECT</b>&#160;&#160;&#160;'C'</td></tr>
<tr class="separator:a14691deb9ba5dc93a2bb3e0e8b4fdfd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a663fe77d23ffb3b8c37f51583faf7c17"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a663fe77d23ffb3b8c37f51583faf7c17"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_ROOM</b>&#160;&#160;&#160;'R'</td></tr>
<tr class="separator:a663fe77d23ffb3b8c37f51583faf7c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a58b4c3522a04c4a0a65f9ad99f6a00"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a58b4c3522a04c4a0a65f9ad99f6a00"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_AUTONOMOUS</b>&#160;&#160;&#160;'E'</td></tr>
<tr class="separator:a9a58b4c3522a04c4a0a65f9ad99f6a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a764dbd349d8621accd792ee5210a3f74"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a764dbd349d8621accd792ee5210a3f74"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_FORWARD</b>&#160;&#160;&#160;'W'</td></tr>
<tr class="separator:a764dbd349d8621accd792ee5210a3f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1681b01a2698687a9b6aedd45b796f40"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1681b01a2698687a9b6aedd45b796f40"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_BACKWARD</b>&#160;&#160;&#160;'S'</td></tr>
<tr class="separator:a1681b01a2698687a9b6aedd45b796f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa05ecc497d01a93be5dd62ddaee54a75"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa05ecc497d01a93be5dd62ddaee54a75"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_LEFT</b>&#160;&#160;&#160;'A'</td></tr>
<tr class="separator:aa05ecc497d01a93be5dd62ddaee54a75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94f7d75840f1acbd2c2acd01fc115d88"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a94f7d75840f1acbd2c2acd01fc115d88"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_RIGHT</b>&#160;&#160;&#160;'D'</td></tr>
<tr class="separator:a94f7d75840f1acbd2c2acd01fc115d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a245db460299318b2a2b61c2f884c1d19"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a245db460299318b2a2b61c2f884c1d19"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>CHAR_STOP</b>&#160;&#160;&#160;0x20</td></tr>
<tr class="separator:a245db460299318b2a2b61c2f884c1d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a980e950615d86dadef54f3cfaefb5fb4"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#a980e950615d86dadef54f3cfaefb5fb4">OPERATING_MODE</a> { <b>GUIDED_NAVIGATE</b>, 
<b>SEARCH_ROOM</b>, 
<b>AUTONOMOUS_NAVIGATE</b>
 }</td></tr>
<tr class="memdesc:a980e950615d86dadef54f3cfaefb5fb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">enum for which operating 'mode' the robot is in  <a href="robotcode_8ino.html#a980e950615d86dadef54f3cfaefb5fb4">More...</a><br /></td></tr>
<tr class="separator:a980e950615d86dadef54f3cfaefb5fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc716dd21485bffb9015eaeb3cfe6859"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a> { <br />
&#160;&#160;<b>FORWARD</b>, 
<b>BACKWARD</b>, 
<b>LEFT</b>, 
<b>RIGHT</b>, 
<br />
&#160;&#160;<b>SEARCH</b>, 
<b>NONE</b>
<br />
 }</td></tr>
<tr class="memdesc:adc716dd21485bffb9015eaeb3cfe6859"><td class="mdescLeft">&#160;</td><td class="mdescRight">enum for which movement/action is taking place  <a href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">More...</a><br /></td></tr>
<tr class="separator:adc716dd21485bffb9015eaeb3cfe6859"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9a97a20c8deb22c7db7d5cbd5d10a98f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a97a20c8deb22c7db7d5cbd5d10a98f"></a>
NewPing&#160;</td><td class="memItemRight" valign="bottom"><b>sonar</b> (TRIGGER_PIN, ECHO_PIN, MAX_DISTANCE)</td></tr>
<tr class="separator:a9a97a20c8deb22c7db7d5cbd5d10a98f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbe89b02b936909feba8810c9675390f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#abbe89b02b936909feba8810c9675390f">parseGuidedNavigate</a> (char recv)</td></tr>
<tr class="memdesc:abbe89b02b936909feba8810c9675390f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Responsible for parsing special commands in GUIDED_NAVIGATE mode.  <a href="#abbe89b02b936909feba8810c9675390f">More...</a><br /></td></tr>
<tr class="separator:abbe89b02b936909feba8810c9675390f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaf5bee7c4545b94a6adda4907544241"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#aaaf5bee7c4545b94a6adda4907544241">parseSearchRoom</a> (char recv)</td></tr>
<tr class="memdesc:aaaf5bee7c4545b94a6adda4907544241"><td class="mdescLeft">&#160;</td><td class="mdescRight">Responsible for parsing special commands in SEARCH_ROOM mode.  <a href="#aaaf5bee7c4545b94a6adda4907544241">More...</a><br /></td></tr>
<tr class="separator:aaaf5bee7c4545b94a6adda4907544241"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb00c91c925985a922f8c668dd439000"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#adb00c91c925985a922f8c668dd439000">parseMovement</a> (char recv)</td></tr>
<tr class="memdesc:adb00c91c925985a922f8c668dd439000"><td class="mdescLeft">&#160;</td><td class="mdescRight">Responsible for parsing movement commands in any mode.  <a href="#adb00c91c925985a922f8c668dd439000">More...</a><br /></td></tr>
<tr class="separator:adb00c91c925985a922f8c668dd439000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ad219170e626db83c63dfb8629d38c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#a28ad219170e626db83c63dfb8629d38c">runAutonomousMode</a> ()</td></tr>
<tr class="memdesc:a28ad219170e626db83c63dfb8629d38c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the logged movements/actions stored from guided mode.  <a href="#a28ad219170e626db83c63dfb8629d38c">More...</a><br /></td></tr>
<tr class="separator:a28ad219170e626db83c63dfb8629d38c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe70bedfede401b2e61d7e2a54120bea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#afe70bedfede401b2e61d7e2a54120bea">calcMovement</a> (<a class="el" href="structMOVEMENT__COORD.html">MOVEMENT_COORD</a> mov)</td></tr>
<tr class="memdesc:afe70bedfede401b2e61d7e2a54120bea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the optimised/needed movement needed in autonomos mode.  <a href="#afe70bedfede401b2e61d7e2a54120bea">More...</a><br /></td></tr>
<tr class="separator:afe70bedfede401b2e61d7e2a54120bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af776ff77e94170ec456760c6962020e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a> (<a class="el" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a> movement)</td></tr>
<tr class="memdesc:af776ff77e94170ec456760c6962020e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Moves the robot in a certain direction.  <a href="#af776ff77e94170ec456760c6962020e5">More...</a><br /></td></tr>
<tr class="separator:af776ff77e94170ec456760c6962020e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8fb70ddbf7925148a848bd3c1df2b94"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#ad8fb70ddbf7925148a848bd3c1df2b94">checkForObject</a> ()</td></tr>
<tr class="memdesc:ad8fb70ddbf7925148a848bd3c1df2b94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the ultrasonic sensor to search the room for an object.  <a href="#ad8fb70ddbf7925148a848bd3c1df2b94">More...</a><br /></td></tr>
<tr class="separator:ad8fb70ddbf7925148a848bd3c1df2b94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd77e61b6e1d72ce91e71cdbd86e3724"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#abd77e61b6e1d72ce91e71cdbd86e3724">correctPath</a> ()</td></tr>
<tr class="memdesc:abd77e61b6e1d72ce91e71cdbd86e3724"><td class="mdescLeft">&#160;</td><td class="mdescRight">procedure for path correction to stop wall collisions  <a href="#abd77e61b6e1d72ce91e71cdbd86e3724">More...</a><br /></td></tr>
<tr class="separator:abd77e61b6e1d72ce91e71cdbd86e3724"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d3a70671b195d39ddeb7a437b85d957"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#a2d3a70671b195d39ddeb7a437b85d957">isWallFound</a> ()</td></tr>
<tr class="memdesc:a2d3a70671b195d39ddeb7a437b85d957"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks to see if a wall is found using reflectance sensors.  <a href="#a2d3a70671b195d39ddeb7a437b85d957">More...</a><br /></td></tr>
<tr class="separator:a2d3a70671b195d39ddeb7a437b85d957"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a14e59caf883ee2936af076b102c68e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a> (int startSensor, int endSensor)</td></tr>
<tr class="memdesc:a7a14e59caf883ee2936af076b102c68e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to check how many sensors are on a wall.  <a href="#a7a14e59caf883ee2936af076b102c68e">More...</a><br /></td></tr>
<tr class="separator:a7a14e59caf883ee2936af076b102c68e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11b381faabbecc0143d11cf09e955462"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#a11b381faabbecc0143d11cf09e955462">calibrateSensors</a> ()</td></tr>
<tr class="memdesc:a11b381faabbecc0143d11cf09e955462"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calibrates the reflectance sensors on the robot.  <a href="#a11b381faabbecc0143d11cf09e955462">More...</a><br /></td></tr>
<tr class="separator:a11b381faabbecc0143d11cf09e955462"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fc01d736fe50cf5b977f755b675f11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#a4fc01d736fe50cf5b977f755b675f11d">setup</a> ()</td></tr>
<tr class="memdesc:a4fc01d736fe50cf5b977f755b675f11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs once at boot of arduino. Responsible for settings up peripherals.  <a href="#a4fc01d736fe50cf5b977f755b675f11d">More...</a><br /></td></tr>
<tr class="separator:a4fc01d736fe50cf5b977f755b675f11d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#afe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:afe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">System loop that is ran continuously.  <a href="#afe461d27b9c48d5921c00d521181f12f">More...</a><br /></td></tr>
<tr class="separator:afe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98da970f4d5707cef3faf45d97b2a0a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="robotcode_8ino.html#a98da970f4d5707cef3faf45d97b2a0a9">parseAutonomous</a> (char recv)</td></tr>
<tr class="memdesc:a98da970f4d5707cef3faf45d97b2a0a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Responsible for parsing special commands in AUTONOMOUS_NAVIGATE mode.  <a href="#a98da970f4d5707cef3faf45d97b2a0a9">More...</a><br /></td></tr>
<tr class="separator:a98da970f4d5707cef3faf45d97b2a0a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a107e8fa5802407f91589286783cb7c5d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a107e8fa5802407f91589286783cb7c5d"></a>
ZumoMotors&#160;</td><td class="memItemRight" valign="bottom"><b>motors</b></td></tr>
<tr class="separator:a107e8fa5802407f91589286783cb7c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a843402006805fb58c2fd952b79d491d8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a843402006805fb58c2fd952b79d491d8"></a>
ZumoReflectanceSensorArray&#160;</td><td class="memItemRight" valign="bottom"><b>reflectanceSensors</b></td></tr>
<tr class="separator:a843402006805fb58c2fd952b79d491d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af589ed314ba3266f151b5c974f6868ea"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af589ed314ba3266f151b5c974f6868ea"></a>
<a class="el" href="robotcode_8ino.html#a980e950615d86dadef54f3cfaefb5fb4">OPERATING_MODE</a>&#160;</td><td class="memItemRight" valign="bottom"><b>robotMode</b> = GUIDED_NAVIGATE</td></tr>
<tr class="separator:af589ed314ba3266f151b5c974f6868ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a834bdca1649fc7a14bcd0ef9c5d8b2ec"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a834bdca1649fc7a14bcd0ef9c5d8b2ec"></a>
<a class="el" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a>&#160;</td><td class="memItemRight" valign="bottom"><b>currMovement</b> = NONE</td></tr>
<tr class="separator:a834bdca1649fc7a14bcd0ef9c5d8b2ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36454f4d674274472f062b8b609143a1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36454f4d674274472f062b8b609143a1"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>wallDetect</b> = true</td></tr>
<tr class="separator:a36454f4d674274472f062b8b609143a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90c3ccdd5d149c3fa002c1bb5bde0a20"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a90c3ccdd5d149c3fa002c1bb5bde0a20"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>roomCount</b> = 0</td></tr>
<tr class="separator:a90c3ccdd5d149c3fa002c1bb5bde0a20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35b2ab6efdd73d9f5b5f60ea52b2fce2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a35b2ab6efdd73d9f5b5f60ea52b2fce2"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>roomFound</b> [MAX_ROOMS] = {false, false, false, false, false}</td></tr>
<tr class="separator:a35b2ab6efdd73d9f5b5f60ea52b2fce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17773ebf8f2431cdae430c3aeb79fff"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa17773ebf8f2431cdae430c3aeb79fff"></a>
<a class="el" href="structMOVEMENT__COORD.html">MOVEMENT_COORD</a>&#160;</td><td class="memItemRight" valign="bottom"><b>movLog</b> [MAX_COORDINATES]</td></tr>
<tr class="separator:aa17773ebf8f2431cdae430c3aeb79fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64310643aac4e3bb3b3a0c6117b3313b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a64310643aac4e3bb3b3a0c6117b3313b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>movLogCount</b> = 0</td></tr>
<tr class="separator:a64310643aac4e3bb3b3a0c6117b3313b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Zumo Search and Rescue Robot using Arduino Uno. </p>
<dl class="section author"><dt>Author</dt><dd>Jack Allister - b3042098 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>15 Jan 2017 Implementation of the robot code for task 1-6 of assignment 1. Allows manual control, room searching and autonomous navigation. </dd></dl>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="adc716dd21485bffb9015eaeb3cfe6859"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enum for which movement/action is taking place </p>
<p>Robot can be doing 1 of 6 possible movements at a time.<br />
FORWARD, BACKWARD, LEFT, RIGHT<br />
Searching or no action/movement. </p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  FORWARD,</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  BACKWARD,</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  LEFT,</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  RIGHT,</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  SEARCH,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  NONE</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;} <a class="code" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a>;</div>
<div class="ttc" id="robotcode_8ino_html_adc716dd21485bffb9015eaeb3cfe6859"><div class="ttname"><a href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a></div><div class="ttdeci">MOVEMENT</div><div class="ttdoc">enum for which movement/action is taking place </div><div class="ttdef"><b>Definition:</b> robotcode.ino:39</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a980e950615d86dadef54f3cfaefb5fb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="robotcode_8ino.html#a980e950615d86dadef54f3cfaefb5fb4">OPERATING_MODE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>enum for which operating 'mode' the robot is in </p>
<p>Robot can only be in one mode at a time.<br />
GUIDED_NAVIGATE - Robot controlled wirelessly from a computer via XBee.<br />
SEARCH_ROOM - Mode for searching a room, allows use of ultrasonic sensor.<br />
AUTONOMOUS_NAVIGATE - Mode uses stored movements and actions to return to start.<br />
</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  GUIDED_NAVIGATE,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  SEARCH_ROOM,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  AUTONOMOUS_NAVIGATE</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;} <a class="code" href="robotcode_8ino.html#a980e950615d86dadef54f3cfaefb5fb4">OPERATING_MODE</a>;</div>
<div class="ttc" id="robotcode_8ino_html_a980e950615d86dadef54f3cfaefb5fb4"><div class="ttname"><a href="robotcode_8ino.html#a980e950615d86dadef54f3cfaefb5fb4">OPERATING_MODE</a></div><div class="ttdeci">OPERATING_MODE</div><div class="ttdoc">enum for which operating &#39;mode&#39; the robot is in </div><div class="ttdef"><b>Definition:</b> robotcode.ino:25</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afe70bedfede401b2e61d7e2a54120bea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a> calcMovement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structMOVEMENT__COORD.html">MOVEMENT_COORD</a>&#160;</td>
          <td class="paramname"><em>mov</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the optimised/needed movement needed in autonomos mode. </p>
<p>The optimised/needed movement is calculated using a switch case.<br />
Because movements are parsed in a reverse order in runAutonomousMode we needed to inverse some commands for example movements/actions taken place in SEARCH_ROOM mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mov</td><td>- <a class="el" href="structMOVEMENT__COORD.html" title="Structure that is used for logging of actions. ">MOVEMENT_COORD</a> structure/object from movLog to be used in calculation. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MOVEMENT - the optimised movement for the robot to take. </dd></dl>
<div class="fragment"><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a> result = NONE;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">switch</span> (mov.movement)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">case</span> FORWARD:</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordflow">if</span> (mov.mode == SEARCH_ROOM)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        result = BACKWARD;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        result = FORWARD;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">case</span> BACKWARD:</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordflow">if</span> (mov.mode == SEARCH_ROOM)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        result = FORWARD;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        result = BACKWARD;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">case</span> LEFT:</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">if</span> (mov.mode == SEARCH_ROOM)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        result = LEFT;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        result = RIGHT;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">case</span> RIGHT:</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordflow">if</span> (mov.mode == SEARCH_ROOM)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        result = RIGHT;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        result = LEFT;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_adc716dd21485bffb9015eaeb3cfe6859"><div class="ttname"><a href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a></div><div class="ttdeci">MOVEMENT</div><div class="ttdoc">enum for which movement/action is taking place </div><div class="ttdef"><b>Definition:</b> robotcode.ino:39</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a11b381faabbecc0143d11cf09e955462"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calibrateSensors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calibrates the reflectance sensors on the robot. </p>
<p>Procedure calibrates the reflectance sensors by moving the robot backwards and forwards over a wall boundary.<br />
This allows accurate wall detection. </p>
<div class="fragment"><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;{</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> MOVE_TIME = 350;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordtype">char</span> dummy;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  Serial.println(<span class="stringliteral">&quot;Calibrating sensors&quot;</span>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  Serial.println(<span class="stringliteral">&quot;Move the robot so that the sensors are just before a line/wall&quot;</span>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  Serial.println(<span class="stringliteral">&quot;Press space to continue&quot;</span>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordflow">while</span> (Serial.available() == 0)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  dummy = Serial.read();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; 10; i++)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> startTime = millis();</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    motors.setSpeeds(MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">while</span> (millis() - startTime &lt; MOVE_TIME)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      reflectanceSensors.calibrate();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    startTime = millis();</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    motors.setSpeeds(-MAX_SPEED, -MAX_SPEED);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">while</span> (millis() - startTime &lt; MOVE_TIME)</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      reflectanceSensors.calibrate();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  motors.setSpeeds(0, 0);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; NUM_SENSORS; i++)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  {</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    Serial.print(<span class="stringliteral">&quot;Minimum values: &quot;</span>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    Serial.print(reflectanceSensors.calibratedMinimumOn[i]);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    Serial.print(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  Serial.println();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  <span class="keywordflow">for</span> (i = 0; i &lt; NUM_SENSORS; i++)</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    Serial.print(<span class="stringliteral">&quot;Maximum values: &quot;</span>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    Serial.print(reflectanceSensors.calibratedMaximumOn[i]);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    Serial.print(<span class="charliteral">&#39; &#39;</span>);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  Serial.println();</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  Serial.println(<span class="stringliteral">&quot;Sensor calibration complete!&quot;</span>);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad8fb70ddbf7925148a848bd3c1df2b94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkForObject </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uses the ultrasonic sensor to search the room for an object. </p>
<p>Robot rotates left while the ultrasonic sensor is on to try and find objects. The robot then returns right while doing the same thing. Maximum distance for the ultrasonic sensor is set at 20cm using the constant MAX_DISTANCE this can be changed to allow up to a maximum of 200cm.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean - Whether an object was discovered. </dd></dl>
<div class="fragment"><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;{</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> TURN_TIME = 750;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> startTime;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> pingDist;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  Serial.println(<span class="stringliteral">&quot;Checking room for objects&quot;</span>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">/* Perform a quick scan of the room using US to find items */</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="comment">/* Check left direction */</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  Serial.println(<span class="stringliteral">&quot;Checking left&quot;</span>);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  motors.setSpeeds(-MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  startTime = millis();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">while</span> ((millis() - startTime) &lt; TURN_TIME)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    delay(50);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    pingDist = sonar.ping_cm();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> ((pingDist != 0) &amp;&amp; (found == <span class="keyword">false</span>))</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="comment">/* If we get here means object found in left of room */</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      Serial.print(<span class="stringliteral">&quot;Object found in left of room &quot;</span>);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      Serial.print(pingDist);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      Serial.println(<span class="stringliteral">&quot; cm away.&quot;</span>);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="comment">/* Move right to midpoint */</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  motors.setSpeeds(MAX_SPEED, -MAX_SPEED);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  startTime = millis();</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="keywordflow">while</span> ((millis() - startTime) &lt; TURN_TIME)</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">/* Do nothing here as returning */</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">/* Check right direction */</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  Serial.println(<span class="stringliteral">&quot;Checking right&quot;</span>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  startTime = millis();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keywordflow">while</span> ((millis() - startTime) &lt; TURN_TIME)</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    delay(50);</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    pingDist = sonar.ping_cm();</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> ((pingDist != 0) &amp;&amp; (found == <span class="keyword">false</span>))</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      <span class="comment">/* If we get here means object found in right of room */</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      Serial.print(<span class="stringliteral">&quot;Object found in right of room &quot;</span>);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      Serial.print(pingDist);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      Serial.println(<span class="stringliteral">&quot; cm away.&quot;</span>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="comment">/* Move left to midpoint */</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  motors.setSpeeds(-MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  startTime = millis();</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">while</span> ((millis() - startTime) &lt; TURN_TIME)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">/* Do nothing here as returning */</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  motors.setSpeeds(0, 0);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  <span class="keywordflow">if</span> (found == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    Serial.println(<span class="stringliteral">&quot;No objects found.&quot;</span>);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <span class="comment">/* Method for storing movement coordinates */</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <span class="keywordflow">if</span> (robotMode != AUTONOMOUS_NAVIGATE)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">/* Set movement and start time */</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> currTime = millis();</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    movLog[movLogCount].mode = robotMode;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    movLog[movLogCount].movement = SEARCH;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    movLog[movLogCount].time = currTime;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    movLog[movLogCount].roomID = roomCount;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">/* Here we correct previous log time so that it is delta/diff */</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (movLogCount != 0)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      movLog[movLogCount-1].time = currTime - movLog[movLogCount-1].time;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    movLogCount++;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  roomFound[roomCount] = found;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  <span class="keywordflow">return</span> found;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd77e61b6e1d72ce91e71cdbd86e3724"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool correctPath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>procedure for path correction to stop wall collisions </p>
<p>Path correction that stops either the left or right side of the robot from accidentally driving over a wall boundary. This function uses the reflectance sensors to do so.<br />
Path correction can only happen once every 50ms.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean - Whether path correction has taken place. </dd></dl>
<div class="fragment"><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;{</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> CORR_INTERVAL = 50;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> LEFT_START = 0;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> RIGHT_START = 5;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lastRun = 0;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordtype">bool</span> result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <a class="code" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a> lastMovement;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="comment">/* Corrects the path to stop a side from accidentally going on a wall */</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">/* Correction happens every 50ms */</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">if</span> ((lastRun == 0) || (millis() - lastRun &gt; CORR_INTERVAL))</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  {</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    lastRun = millis();</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <span class="comment">/* Check to make sure only left sensor is on a line */</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a>(LEFT_START, LEFT_START) &gt; 0) &amp;&amp;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        (<a class="code" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a>(RIGHT_START, RIGHT_START) == 0))</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="comment">/* If true correct path by moving the robot right until not on line */</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      motors.setSpeeds(MAX_SPEED, -MAX_SPEED);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      } <span class="keywordflow">while</span> (<a class="code" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a>(LEFT_START, LEFT_START) &gt; 0);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      motors.setSpeeds(MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      Serial.println(<span class="stringliteral">&quot;Corrected left&quot;</span>);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a>(RIGHT_START, RIGHT_START) &gt; 0) &amp;&amp;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;             (<a class="code" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a>(LEFT_START, LEFT_START) == 0))</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <span class="comment">/* If true correct path by moving the robot left until not on line */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      motors.setSpeeds(-MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">do</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      } <span class="keywordflow">while</span> (<a class="code" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a>(RIGHT_START, RIGHT_START) &gt; 0);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      motors.setSpeeds(MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <span class="comment">/* If far right sensor on a line correct path a little */</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;      Serial.println(<span class="stringliteral">&quot;Corrected right.&quot;</span>);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_adc716dd21485bffb9015eaeb3cfe6859"><div class="ttname"><a href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a></div><div class="ttdeci">MOVEMENT</div><div class="ttdoc">enum for which movement/action is taking place </div><div class="ttdef"><b>Definition:</b> robotcode.ino:39</div></div>
<div class="ttc" id="robotcode_8ino_html_a7a14e59caf883ee2936af076b102c68e"><div class="ttname"><a href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a></div><div class="ttdeci">int isSensorsOver(int startSensor, int endSensor)</div><div class="ttdoc">Function to check how many sensors are on a wall. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:813</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7a14e59caf883ee2936af076b102c68e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int isSensorsOver </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>startSensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>endSensor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to check how many sensors are on a wall. </p>
<p>Checks to see how many sensors are on a wall. Function has the ability to only check certain sensors, this is done by the passed in parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">startSensor</td><td>- The first sensor to check. </td></tr>
    <tr><td class="paramname">endSensor</td><td>- The last sensor to check (endSensor &gt; startSensor). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int - The number of sensors that are on a wall. </dd></dl>
<div class="fragment"><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;{</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> LINE_VALUE = 300;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordtype">int</span> sensorCount = 0;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sensorValues[NUM_SENSORS];</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  reflectanceSensors.readLine(sensorValues);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="keywordflow">for</span> (i = startSensor; i &lt;= endSensor; i++)</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">if</span> (sensorValues[i] &gt;= LINE_VALUE)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      sensorCount++;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">return</span> sensorCount;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2d3a70671b195d39ddeb7a437b85d957"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isWallFound </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks to see if a wall is found using reflectance sensors. </p>
<p>Procedure checks to see if more than one sensor is on a wall. If so the the function returns true.</p>
<dl class="section return"><dt>Returns</dt><dd>boolean - Returns if the robot is on a wall. </dd></dl>
<div class="fragment"><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;{</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> START_SENSOR = 0;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> END_SENSOR = 5;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">int</span> sensorCount = <a class="code" href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a>(START_SENSOR, END_SENSOR);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">/* Return true if more than one sensor detects a line */</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">return</span> (sensorCount &gt; 1);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_a7a14e59caf883ee2936af076b102c68e"><div class="ttname"><a href="robotcode_8ino.html#a7a14e59caf883ee2936af076b102c68e">isSensorsOver</a></div><div class="ttdeci">int isSensorsOver(int startSensor, int endSensor)</div><div class="ttdoc">Function to check how many sensors are on a wall. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:813</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afe461d27b9c48d5921c00d521181f12f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>System loop that is ran continuously. </p>
<p>This loop has been designed to be as non-blocking as possible.<br />
This allows data from the XBee to be parsed as quickly as possible.<br />
<br />
A state machine has been included within here to process action relating to the current operating mode that the robot is in (see OPERATING_MODE). </p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <span class="keywordtype">char</span> recvByte = 0;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="comment">/* Check serial to see if we have received any commands */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> (Serial.available() != 0)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">/* Convert to upper case so command &#39;e&#39; is same as &#39;E&#39; */</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    recvByte = toupper(Serial.read());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">switch</span> (robotMode)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">case</span> GUIDED_NAVIGATE:</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keywordflow">if</span> (recvByte != 0)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">/* Check if received byte is a movement character */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="robotcode_8ino.html#adb00c91c925985a922f8c668dd439000">parseMovement</a>(recvByte) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="comment">/* If not equal to movement character parse other characters */</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <a class="code" href="robotcode_8ino.html#abbe89b02b936909feba8810c9675390f">parseGuidedNavigate</a>(recvByte);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">if</span> (currMovement == FORWARD)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (wallDetect == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <span class="comment">/*</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">           * Wall detection and path correction only work if enabled and</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">           * zumo going forward. This is because there is no point having</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">           * the zumo use its sensors if travelling backwards as none on</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">           * rear side.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">           */</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="robotcode_8ino.html#a2d3a70671b195d39ddeb7a437b85d957">isWallFound</a>() == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(NONE);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            Serial.println(<span class="stringliteral">&quot;Wall found, press C to re-enable when moved.&quot;</span>);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            wallDetect = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;          {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">/* Only correct the path if a wall has not been found */</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="robotcode_8ino.html#abd77e61b6e1d72ce91e71cdbd86e3724">correctPath</a>();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">case</span> SEARCH_ROOM:</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">if</span> (recvByte != 0)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">/* Again parse movement and other room search mode commands */</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="robotcode_8ino.html#adb00c91c925985a922f8c668dd439000">parseMovement</a>(recvByte) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <a class="code" href="robotcode_8ino.html#aaaf5bee7c4545b94a6adda4907544241">parseSearchRoom</a>(recvByte);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">case</span> AUTONOMOUS_NAVIGATE:</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">if</span> (recvByte != 0)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="comment">/* Again parse movement and other autonomous commands (start/leavemode) */</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="robotcode_8ino.html#adb00c91c925985a922f8c668dd439000">parseMovement</a>(recvByte) == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          <a class="code" href="robotcode_8ino.html#a98da970f4d5707cef3faf45d97b2a0a9">parseAutonomous</a>(recvByte);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_abbe89b02b936909feba8810c9675390f"><div class="ttname"><a href="robotcode_8ino.html#abbe89b02b936909feba8810c9675390f">parseGuidedNavigate</a></div><div class="ttdeci">void parseGuidedNavigate(char recv)</div><div class="ttdoc">Responsible for parsing special commands in GUIDED_NAVIGATE mode. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:248</div></div>
<div class="ttc" id="robotcode_8ino_html_af776ff77e94170ec456760c6962020e5"><div class="ttname"><a href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a></div><div class="ttdeci">void moveDirection(MOVEMENT movement)</div><div class="ttdoc">Moves the robot in a certain direction. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:541</div></div>
<div class="ttc" id="robotcode_8ino_html_abd77e61b6e1d72ce91e71cdbd86e3724"><div class="ttname"><a href="robotcode_8ino.html#abd77e61b6e1d72ce91e71cdbd86e3724">correctPath</a></div><div class="ttdeci">bool correctPath()</div><div class="ttdoc">procedure for path correction to stop wall collisions </div><div class="ttdef"><b>Definition:</b> robotcode.ino:732</div></div>
<div class="ttc" id="robotcode_8ino_html_a98da970f4d5707cef3faf45d97b2a0a9"><div class="ttname"><a href="robotcode_8ino.html#a98da970f4d5707cef3faf45d97b2a0a9">parseAutonomous</a></div><div class="ttdeci">void parseAutonomous(char recv)</div><div class="ttdoc">Responsible for parsing special commands in AUTONOMOUS_NAVIGATE mode. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:329</div></div>
<div class="ttc" id="robotcode_8ino_html_adb00c91c925985a922f8c668dd439000"><div class="ttname"><a href="robotcode_8ino.html#adb00c91c925985a922f8c668dd439000">parseMovement</a></div><div class="ttdeci">bool parseMovement(char recv)</div><div class="ttdoc">Responsible for parsing movement commands in any mode. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:363</div></div>
<div class="ttc" id="robotcode_8ino_html_aaaf5bee7c4545b94a6adda4907544241"><div class="ttname"><a href="robotcode_8ino.html#aaaf5bee7c4545b94a6adda4907544241">parseSearchRoom</a></div><div class="ttdeci">void parseSearchRoom(char recv)</div><div class="ttdoc">Responsible for parsing special commands in SEARCH_ROOM mode. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:301</div></div>
<div class="ttc" id="robotcode_8ino_html_a2d3a70671b195d39ddeb7a437b85d957"><div class="ttname"><a href="robotcode_8ino.html#a2d3a70671b195d39ddeb7a437b85d957">isWallFound</a></div><div class="ttdeci">bool isWallFound()</div><div class="ttdoc">Checks to see if a wall is found using reflectance sensors. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:792</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af776ff77e94170ec456760c6962020e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void moveDirection </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a>&#160;</td>
          <td class="paramname"><em>movement</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Moves the robot in a certain direction. </p>
<p>This function is responsible for moving the robot in a certain direction. The passed in parameter is either passed in via Serial/Xbee or from the autonomous navigation loop.<br />
Logging of movements also takes place when in SEARCH_ROOM or GUIDED_NAVIGATE mode, this allows AUTONOMOUS_NAVIGATE mode to use the logged data for it's return path.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">movement</td><td>- The direction that the robot needs to go. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;{</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">/* Method for storing movement coordinates */</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="keywordflow">if</span> (robotMode != AUTONOMOUS_NAVIGATE)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <span class="comment">/* Set movement and start time */</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> currTime = millis();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    movLog[movLogCount].mode = robotMode;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    movLog[movLogCount].movement = movement;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    movLog[movLogCount].time = currTime;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">     * If we movement is in search mode we note down the room.</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">     * If not we just put -1 to signal it is a corridor</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordflow">if</span> (robotMode == SEARCH_ROOM)</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      movLog[movLogCount].roomID = roomCount;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      movLog[movLogCount].roomID = -1;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">/* Here we correct previous log time so that it is delta/diff */</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">if</span> (movLogCount != 0)</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      movLog[movLogCount-1].time = currTime - movLog[movLogCount-1].time;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    movLogCount++;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">/* Switch case for actually moving the robot from the relative command */</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="keywordflow">switch</span> (movement)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">case</span> FORWARD:</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="comment">/* Set values needed for collision detection */</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      currMovement = FORWARD;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      Serial.println(<span class="stringliteral">&quot;Robot moving forwards&quot;</span>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      motors.setSpeeds(MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keywordflow">case</span> BACKWARD:</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="comment">/* Set values needed for collision detection */</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      currMovement = BACKWARD;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      Serial.println(<span class="stringliteral">&quot;Robot moving backwards&quot;</span>);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      motors.setSpeeds(-MAX_SPEED, -MAX_SPEED);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">case</span> LEFT:</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="comment">/* Set values needed for collision detection */</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      currMovement = LEFT;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      Serial.println(<span class="stringliteral">&quot;Robot turning left&quot;</span>);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      motors.setSpeeds(-MAX_SPEED, MAX_SPEED);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">case</span> RIGHT:</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="comment">/* Set values needed for collision detection */</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      currMovement = RIGHT;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      Serial.println(<span class="stringliteral">&quot;Robot turning right&quot;</span>);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      motors.setSpeeds(MAX_SPEED, -MAX_SPEED);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">case</span> NONE:</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      Serial.println(<span class="stringliteral">&quot;Robot stopping&quot;</span>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      motors.setSpeeds(0, 0);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="comment">/* Set values needed for collision detection */</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      currMovement = NONE;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a98da970f4d5707cef3faf45d97b2a0a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseAutonomous </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>recv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Responsible for parsing special commands in AUTONOMOUS_NAVIGATE mode. </p>
<p>This procedure is responsible for parsing commands only used in AUTONOMOUS_NAVIGATE operating mode. For example starting autonomos navigation and returning back to GUIDED_NAVIGATE mode.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recv</td><td>- Received command byte from serial/XBee. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;{</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">switch</span> (recv)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">case</span> CHAR_START_AUTONOMOUS:</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="robotcode_8ino.html#a28ad219170e626db83c63dfb8629d38c">runAutonomousMode</a>();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">case</span> CHAR_AUTONOMOUS:</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      robotMode = GUIDED_NAVIGATE;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      digitalWrite(LED_PIN, LOW);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      Serial.println(<span class="stringliteral">&quot;Leaving autonomous mode, going back to guided&quot;</span>);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_a28ad219170e626db83c63dfb8629d38c"><div class="ttname"><a href="robotcode_8ino.html#a28ad219170e626db83c63dfb8629d38c">runAutonomousMode</a></div><div class="ttdeci">void runAutonomousMode()</div><div class="ttdoc">Runs the logged movements/actions stored from guided mode. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:424</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abbe89b02b936909feba8810c9675390f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseGuidedNavigate </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>recv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Responsible for parsing special commands in GUIDED_NAVIGATE mode. </p>
<p>This procedure is responsible for parsing commands only needed while in GUIDED_NAVIGATE mode. For example enabling wall detect, calibration, switching to SEARCH_ROOM mode etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recv</td><td>- Received command byte from serial/XBee. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;{</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">switch</span> (recv)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordflow">case</span> CHAR_CALIBRATE:</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <a class="code" href="robotcode_8ino.html#a11b381faabbecc0143d11cf09e955462">calibrateSensors</a>();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">case</span> CHAR_WALL_DETECT:</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">if</span> (wallDetect == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        wallDetect = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        Serial.println(<span class="stringliteral">&quot;Wall detect enabled&quot;</span>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        Serial.println(<span class="stringliteral">&quot;Wall detect already enabled&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">case</span> CHAR_ROOM:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      robotMode = SEARCH_ROOM;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      roomCount++;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      Serial.print(<span class="stringliteral">&quot;Room search: &quot;</span>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      Serial.println(roomCount);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">case</span> CHAR_AUTONOMOUS:</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      robotMode = AUTONOMOUS_NAVIGATE;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      digitalWrite(LED_PIN, HIGH);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      Serial.println(<span class="stringliteral">&quot;Autonomous mode started, rotate 180* then press 3&quot;</span>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_a11b381faabbecc0143d11cf09e955462"><div class="ttname"><a href="robotcode_8ino.html#a11b381faabbecc0143d11cf09e955462">calibrateSensors</a></div><div class="ttdeci">void calibrateSensors()</div><div class="ttdoc">Calibrates the reflectance sensors on the robot. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:839</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adb00c91c925985a922f8c668dd439000"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool parseMovement </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>recv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Responsible for parsing movement commands in any mode. </p>
<p>This procedure is responsible for parsing movement commands used in any operating mode. These commands however WILL NOT work while calibration is taking place or the autnomous navigation is running through logged movements.<br />
If the received command is not a movement command the function returns false, This is to show the parent function that the command may be a special mode dependent command.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recv</td><td>- Received command byte from serial/XBee. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>boolean - Whether a valid movement command was found. </dd></dl>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordtype">bool</span> result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <span class="keywordflow">switch</span> (recv)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">case</span> CHAR_FORWARD:</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(FORWARD);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">case</span> CHAR_BACKWARD:</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(BACKWARD);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">case</span> CHAR_LEFT:</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(LEFT);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">case</span> CHAR_RIGHT:</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(RIGHT);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">case</span> CHAR_STOP:</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(NONE);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">       * If character does not match a movement key</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">       * this function should return false.</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;       result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    }</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_af776ff77e94170ec456760c6962020e5"><div class="ttname"><a href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a></div><div class="ttdeci">void moveDirection(MOVEMENT movement)</div><div class="ttdoc">Moves the robot in a certain direction. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:541</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaaf5bee7c4545b94a6adda4907544241"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parseSearchRoom </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>recv</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Responsible for parsing special commands in SEARCH_ROOM mode. </p>
<p>This procedure is responsible for parsing commands only used in SEARCH_ROOM operating mode. For example starting a room search for objects and switching out of SEARCH_ROOM back to GUIDED_NAVIGATE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">recv</td><td>- Received command byte from serial/XBee. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;{</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">switch</span> (recv)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">case</span> CHAR_CHECK_ROOM:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="robotcode_8ino.html#ad8fb70ddbf7925148a848bd3c1df2b94">checkForObject</a>();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">case</span> CHAR_ROOM:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      robotMode = GUIDED_NAVIGATE;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      Serial.println(<span class="stringliteral">&quot;Leaving search mode, going back to guided&quot;</span>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_ad8fb70ddbf7925148a848bd3c1df2b94"><div class="ttname"><a href="robotcode_8ino.html#ad8fb70ddbf7925148a848bd3c1df2b94">checkForObject</a></div><div class="ttdeci">bool checkForObject()</div><div class="ttdoc">Uses the ultrasonic sensor to search the room for an object. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:634</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28ad219170e626db83c63dfb8629d38c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void runAutonomousMode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the logged movements/actions stored from guided mode. </p>
<p>This function allows the robot to navigate back to the start of the building blueprint.<br />
Actions/movements that take less than 400ms or more than 8000ms are ignored. This is to try and reduce the amount of redundant actions taking place and speed up the overall process of autnomous searching and returning back to the start.<br />
Actions are stored in the movLog array which is of type <a class="el" href="structMOVEMENT__COORD.html" title="Structure that is used for logging of actions. ">MOVEMENT_COORD</a>. </p>
<div class="fragment"><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;{</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> MIN_LOG_TIME = 400;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_LOG_TIME = 8000;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a> nextMovement;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> startTime;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">for</span> (i = movLogCount; i != -1; i--)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    Serial.print(<span class="stringliteral">&quot;Running action: &quot;</span>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    Serial.println(i);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">/* This if statement eliminates any possible &#39;empty&#39; rooms from route back */</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> ((movLog[i].mode != SEARCH_ROOM) || (roomFound[movLog[i].roomID] == <span class="keyword">true</span>))</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="comment">/* Check to see if relates to a search or movmeent */</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">if</span> (movLog[i].movement != SEARCH)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keywordflow">if</span> ((movLog[i].time &gt;= MIN_LOG_TIME) &amp;&amp;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            (movLog[i].time &lt;= MAX_LOG_TIME))</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          nextMovement = <a class="code" href="robotcode_8ino.html#afe70bedfede401b2e61d7e2a54120bea">calcMovement</a>(movLog[i]);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="comment">/* Move in inverse direction to backtrace */</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          startTime = millis();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(nextMovement);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <span class="keywordflow">while</span> (millis() - startTime &lt; movLog[i].time)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;          {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">if</span> (nextMovement == FORWARD)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="robotcode_8ino.html#a2d3a70671b195d39ddeb7a437b85d957">isWallFound</a>() == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <a class="code" href="robotcode_8ino.html#abd77e61b6e1d72ce91e71cdbd86e3724">correctPath</a>();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;          }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          motors.setSpeeds(0, 0);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="robotcode_8ino.html#ad8fb70ddbf7925148a848bd3c1df2b94">checkForObject</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <a class="code" href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a>(NONE);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
<div class="ttc" id="robotcode_8ino_html_adc716dd21485bffb9015eaeb3cfe6859"><div class="ttname"><a href="robotcode_8ino.html#adc716dd21485bffb9015eaeb3cfe6859">MOVEMENT</a></div><div class="ttdeci">MOVEMENT</div><div class="ttdoc">enum for which movement/action is taking place </div><div class="ttdef"><b>Definition:</b> robotcode.ino:39</div></div>
<div class="ttc" id="robotcode_8ino_html_afe70bedfede401b2e61d7e2a54120bea"><div class="ttname"><a href="robotcode_8ino.html#afe70bedfede401b2e61d7e2a54120bea">calcMovement</a></div><div class="ttdeci">MOVEMENT calcMovement(MOVEMENT_COORD mov)</div><div class="ttdoc">Calculates the optimised/needed movement needed in autonomos mode. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:483</div></div>
<div class="ttc" id="robotcode_8ino_html_af776ff77e94170ec456760c6962020e5"><div class="ttname"><a href="robotcode_8ino.html#af776ff77e94170ec456760c6962020e5">moveDirection</a></div><div class="ttdeci">void moveDirection(MOVEMENT movement)</div><div class="ttdoc">Moves the robot in a certain direction. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:541</div></div>
<div class="ttc" id="robotcode_8ino_html_ad8fb70ddbf7925148a848bd3c1df2b94"><div class="ttname"><a href="robotcode_8ino.html#ad8fb70ddbf7925148a848bd3c1df2b94">checkForObject</a></div><div class="ttdeci">bool checkForObject()</div><div class="ttdoc">Uses the ultrasonic sensor to search the room for an object. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:634</div></div>
<div class="ttc" id="robotcode_8ino_html_abd77e61b6e1d72ce91e71cdbd86e3724"><div class="ttname"><a href="robotcode_8ino.html#abd77e61b6e1d72ce91e71cdbd86e3724">correctPath</a></div><div class="ttdeci">bool correctPath()</div><div class="ttdoc">procedure for path correction to stop wall collisions </div><div class="ttdef"><b>Definition:</b> robotcode.ino:732</div></div>
<div class="ttc" id="robotcode_8ino_html_a2d3a70671b195d39ddeb7a437b85d957"><div class="ttname"><a href="robotcode_8ino.html#a2d3a70671b195d39ddeb7a437b85d957">isWallFound</a></div><div class="ttdeci">bool isWallFound()</div><div class="ttdoc">Checks to see if a wall is found using reflectance sensors. </div><div class="ttdef"><b>Definition:</b> robotcode.ino:792</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4fc01d736fe50cf5b977f755b675f11d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs once at boot of arduino. Responsible for settings up peripherals. </p>
<p>Responsible for setting up everything needed for the peripherals.<br />
Xbee, reflectance sensors, motors, LED pin. </p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">/* Initialise serial needed for wireless coms via XBee */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  Serial.begin(9600);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">/* Initialise reflectance sensors for wall detection */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  reflectanceSensors.init();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">/* Make sure the robot is not moving */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  motors.setSpeeds(0, 0);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">/* Initialise LED pin */</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  pinMode(LED_PIN, OUTPUT);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jan 15 2017 18:21:12 for Zumo Assignment by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
